<!doctype html>
<html>
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
<title>Compare Scholars</title>
<body>
    <center>
        <h1>Analyse Scholars' Citations!</h1>
        <!-- <form method="POST">
            <input name="add_researcher" id="input_researcher" list="profile_list">
            <input type="submit" value="Find researcher">
        </form> -->
        <!-- <div id="suggest_container" style="display:inline-block;">
            <datalist id="profile_list">
                <option >{{profiles}}</option>
            </datalist>
        </div> -->

        <!-- Dropdown container -->
        <div class="dropdown">
            <form method="POST" id="input_form">
                <input name="add_researcher" id="input_researcher" onclick="show_suggestions()" class="dropbtn" autofocus>
                <!-- Dropdown</button> -->
                <!-- <div id="myDropdown" class="dropdown-content">
                    <a href="#aaa">aaa</a>
                    <a href="#bb">bb</a>
                </div> -->
                <input type="submit" value="Find researcher">
            </form>
        </div>

        <!-- <select name="cars" id="cars" size="3">
            <option value="volvo">Volvo</option>
            <option value="saab">Saab</option>
            <option value="mercedes">Mercedes</option>
            <option value="audi">Audi</option>
        </select> -->
        <div id="profiles" class="description">{{profiles}}</div>
        <div class="description">Loading can be a bit slow, please be patient :)</div>
        <form method="POST">
            <input type="submit" name="reset_button" value="Reset">
        </form>
        <div id='bar' class='chart'></div>
        <div id='timeline' class='chart'></div>
    </center>
</body>

<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
<script type='text/javascript'>
    // author suggestions
    // TODO this doesn't work!!
    // var profiles = {{profiles}};
    // document.getElementById("profiles").innerHTML = 'lul';

    // function simulateMouseClick(targetNode) {
    //     function triggerMouseEvent(targetNode, eventType) {
    //         var clickEvent = document.createEvent('MouseEvents');
    //         clickEvent.initEvent(eventType, true, true);
    //         targetNode.dispatchEvent(clickEvent);
    //     }
    //     ["mouseover", "mousedown", "mouseup", "click"].forEach(function(eventType) { 
    //         triggerMouseEvent(targetNode, eventType);
    //     });
    // }

    // simulateMouseClick(document.getElementById("input_researcher"));

    function show_suggestions() {
        /* Toggle show/hide */
        document.getElementById("myDropdown").classList.toggle("show");
    }

    window.onclick = function(event) {
        // Close the dropdown if the user clicks outside of it
        if (!event.target.matches('.dropbtn')) {
            var dropdowns = document.getElementsByClassName("dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
                var openDropdown = dropdowns[i];
                if (openDropdown.classList.contains('show')) {
                    openDropdown.classList.remove('show');
                }
            }
        }
    }

    // create dropdown div
    var dropdown = document.createElement("div");
    dropdown.id = "myDropdown";
    dropdown.setAttribute("class", "dropdown-content")
    // add inner links
    option = document.createElement('a');
    option.innerHTML = "{{profiles}}";
    dropdown.appendChild(option);
    // append to document
    var input_form = document.getElementById("input_form")
    input_form.appendChild(dropdown);
    // Show dropdown menu
    show_suggestions();
    document.getElementById("input_researcher").focus();
    document.getElementById("input_researcher").value = '';

    // bar plot
    var bar = {{bar | safe}};
    Plotly.plot('bar', bar, {});
    // line plot
    var timeline = {{timeline | safe}};
    Plotly.plot('timeline', timeline, {});
</script>

</html>
